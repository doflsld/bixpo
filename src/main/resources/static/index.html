<?php
require ('weather.php');

$weather = new weather();
?>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Battery Safety Monitoring System</title>
    <!--favicon-->

    <!--css-->
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/chart.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">

    <!--script-->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://kit.fontawesome.com/ee1626188c.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/data.js"></script>
    <script src="https://code.highcharts.com/modules/series-label.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>


</head>
<body onload=printUpdate(); style="background: #f3f3f3;">
<div class="container-fluid">
    <div class="row" style="height: 80px; background-color: #f08300; margin-bottom: 10px;">
        <div class="col-1" style="line-height: 80px;"><img src="asset/images/s-images/ba_w.png" alt="BA_logo"></div>
        <div class="col-9"><h2 style="line-height: 80px; color: white; font-weight: bold; margin-left: -40px;">배터리 세이프티 박스 관제 모니터링</h2></div>
        <div class="col-1" style="color: #fff; text-align: center; margin-top: 4px;">
            <p style="margin-bottom: -4px;"><?php echo $weather->getStatus(); ?></p>
            <span style="margin-bottom: -4px;"><?php echo $weather->getTemp(); ?>℃</span>
            <span><?php echo $weather->getHumi(); ?>%</span>
        </div>
        <div class="col-1" id="clock" style="color: #fff; text-align: center; margin-top: 18px;">
            <p style="margin-bottom: -4px;">{{date}}</p>
            <p>{{time}}</p>
        </div>
    </div>
    <div class="row" style="height: 850px">
        <div class="col">
            <div class="row" style="background-color: #F3F3F3; height: 100%">
                <div class="col">
                    <div class="row" style="float: none; height: 100%;">
                        <div class="row">
                            <h3>Location</h3>
                            <div id="map" class="shadow rounded" style="margin-left: 10px; width:100%; height:720px; margin-top: -80px;"></div>
                        </div>
                    </div>
                </div>
                <div class="col-7">
                    <div class="row">
                        <h3>IoT Sensor Info</h3>
                    </div>
                    <div class="row" style="text-align: center;  float: none; margin:100 auto;">
                        <div class="card bg-light mb-2 shadow p-3 mb-5 bg-white rounded" style="max-width: 13rem; float: none; margin:0 auto;">
                            <div class="card-header">#001</div>
                            <div class="card-body">
                                <h5 class="card-title" >온도</h5>
                                <p class="card-text" id="temp-1">20℃</p>
                                <h5 class="card-title">습도</h5>
                                <p class="card-text" id="humi-1">60%</p>
                            </div>
                        </div>
                        <div class="card bg-light mb-2 shadow p-3 mb-5 bg-white rounded" style="max-width: 13rem; float: none; margin:0 auto;">
                            <div class="card-header">#002</div>
                            <div class="card-body">
                                <h5 class="card-title">온도</h5>
                                <p class="card-text" id="temp-2">20℃</p>
                                <h5 class="card-title">습도</h5>
                                <p class="card-text" id="humi-2">60%</p>
                            </div>
                        </div>
                        <div class="card bg-light mb-2 shadow p-3 mb-5 bg-white rounded" style="max-width: 13rem; float: none; margin:0 auto;">
                            <div class="card-header">#003</div>
                            <div class="card-body">
                                <h5 class="card-title">온도</h5>
                                <p class="card-text" id="temp-3">20℃</p>
                                <h5 class="card-title">습도</h5>
                                <p class="card-text" id="humi-3">60%</p>
                            </div>
                        </div>
                        <div class="card bg-light mb-2 shadow p-3 mb-5 bg-white rounded" style="max-width: 13rem; float: none; margin:0 auto;">
                            <div class="card-header">#004</div>
                            <div class="card-body">
                                <h5 class="card-title">온도</h5>
                                <p class="card-text" id="temp-4">20℃</p>
                                <h5 class="card-title">습도</h5>
                                <p class="card-text" id="humi-4">60%</p>
                            </div>
                        </div>
                        <div class="card bg-light mb-2 shadow p-3 mb-5 bg-white rounded" style="max-width: 13rem; float: none; margin:0 auto;">
                            <div class="card-header">#005</div>
                            <div class="card-body">
                                <h5 class="card-title">CO</h5>
                                <p class="card-text" id="co2_val">0.00ppm</p>
                                <h5 class="card-title">H₂</h5>
                                <p class="card-text" id="h2_val">0.00ppm</p>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6">
                            <h3>Analysis Graph</h3>
                        </div>
                        <div class="col-6">
                            <h3>Event Viewer</h3>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6">
                            <figure class="highcharts-figure">
                                <div id="bar-chart" class="shadow rounded"></div>
                            </figure>
                        </div>
                        <div class="col-6">
                            <table class="table shadow rounded" style="background-color: #fff; height: 96%;">
                                <thead class="table-light">
                                <tr>
                                    <th scope="col">No</th>
                                    <th scope="col">Issue</th>
                                    <th scope="col">Err Code</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <th scope="row">- </th>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <th scope="row">-</th>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <th scope="row">-</th>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <th scope="row">-</th>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <th scope="row">-</th>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <th scope="row">-</th>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <th scope="row">-</th>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <th scope="row">-</th>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>

                                </tbody>
                            </table>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<script src="js/index.js"></script>
<script src="js/chart.js"></script>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=c9969c8662ad8d9cbb5042d8b658f586&libraries=services"></script>
<script>
    var clockFun = (function (){
        var clock = new Vue({
            el: '#clock',
            data: {
                time : '',
                date : ''
            }
        });

        var week = ['SUN','MON','TUE','WEN','THU','FRI','SAT'];

        function updateTime() {
            var cd = new Date();
            clock.time = zeroPadding(cd.getHours(), 2) + ':' + zeroPadding(cd.getMinutes(), 2) + ":" + zeroPadding(cd.getSeconds(), 2);
            clock.date = zeroPadding(cd.getFullYear(), 4) + '-' + zeroPadding(cd.getMonth() + 1, 2) + '-' + zeroPadding(cd.getDate(), 2) + ' ' + week [cd.getDay()];
        }

        function zeroPadding(num, digit){
            var zero = '';
            for (var i = 0; i < digit; i++){
                zero += 0;
            }
            return (zero + num).slice(-digit);
        }
        return setInterval(updateTime, 1000);
    }());
</script>
<script>
    var mapContainer = document.getElementById('map'), // 지도를 표시할 div
        mapOption = {
            center: new kakao.maps.LatLng(37.670097, 126.745104), // 지도의 중심좌표
            level: 4 // 지도의 확대 레벨
        };

    var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다

    var imageSrc = 'asset/images/s-images/bsb_tesla.png', // 마커이미지의 주소입니다
        imageSize = new kakao.maps.Size(64, 69), // 마커이미지의 크기입니다
        imageOption = {offset: new kakao.maps.Point(0, 0)}; // 마커이미지의 옵션입니다. 마커의 좌표와 일치시킬 이미지 안에서의 좌표를 설정합니다.

    // 마커의 이미지정보를 가지고 있는 마커이미지를 생성합니다
    var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption),
        markerPosition = new kakao.maps.LatLng(37.670097, 126.745104); // 마커가 표시될 위치입니다

    // 마커를 생성합니다
    var marker = new kakao.maps.Marker({
        position: markerPosition,
        image: markerImage // 마커이미지 설정
    });

    // 마커가 지도 위에 표시되도록 설정합니다
    marker.setMap(map);
</script>
</body>
</html>